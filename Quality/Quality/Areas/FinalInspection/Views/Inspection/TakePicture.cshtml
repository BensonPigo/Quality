@using DatabaseObject.Public

@{
    Layout = null;
    Int64 DetailUkey = ViewData["DetailUkey"] == null ? 0 : Convert.ToInt64(ViewData["DetailUkey"]);
    Int64 RowIndex = ViewData["RowIndex"] == null ? 0 : Convert.ToInt64(ViewData["RowIndex"]);

}

@model Window_Picture

<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<link href="~/ThirdParty/SciCustom/css/style.css" rel="stylesheet" />
<style>

    ul {
        padding: 0;
    }

    li {
        list-style-type: none;
        border: 1px solid black;
        padding: 2px;
    }

    td {
        border-style: ridge;
    }

    .leftDiv {
        width: 45%;
        height: 90%;
        float: left;
        margin-right: 2%;
    }

    .outerDiv {
        width: 95vw;
        height: 90%;
        float: left;
        margin-right: 2%;
    }

    .grayDiv {
        width: 100%;
        height: 8vh;
        background-color: lightgray;
        text-align: center;
    }

    .pointer {
        cursor: pointer;
    }
</style>
<br />
<header>
    <h3 style="width:85%;float:left;margin:0"></h3>
    <input id="btnSave" type="button" value="Save" />
    <input id="btnExit" type="button" value="Exit" />
</header>
<br />
<div class="outerDiv" style="margin-right:2%;overflow-y:scroll;">

    @using (Html.BeginForm("TakePicture", "Inspection", FormMethod.Post, new { @id = "TakePictureForm", onsubmit = "return checkValue(this.submitted)" }))
    {
        <div class="grayDiv">
            <img Type="Pic" class="OpenCamera pointer" style="height:80%;padding-top:5px" src="~/Image/Icon/Camera.png" />
            <img id="Del" class="pointer" style="height:80%;padding-top:5px" src="~/Image/Icon/Delete.png" />

        </div>
        <h4>Remark</h4>

        <input type="text" id="Rmk" style="width:90%;border:2px solid black;" name="name" value="" />
        <br />
        <br />
        <img id="ImgPic" Type="Pic" style="width:100%;" />
    }
</div>

@{
    Html.RenderPartial("ScreenShot");
}

<script>

    var ID_List = [];
    var Name_List = [];
    $(function () {


        // Screenshot Exit
        $('#btnScreenshotExit').on('click', function () {
            StopScreen();
            $('#Screenshot').addClass("display-None");
        });


        $("#btnSave").click(function () {

            var Pic = document.querySelectorAll("#ImgPic");
            var Rmk = $("#Rmk").val();

            var Picture = {
                DetailUkey: '@DetailUkey',
                RowIndex : '@RowIndex',
                Img: Pic[0].src,
                Remark: Rmk,
            }

            window.opener.GetImage(Picture);
            window.close();
        });


        $("#btnExit").click(function () {
            window.close();
        });

        $("#Del").click(function () {

            $("#ImgPic").removeAttr("src");
            $("#Rmk").val("");
        });

        CamInit();


    });

    function CamInit() {
        $('.OpenCamera').on('click', function () {

            var Type = $(this).attr('Type');
            var sentID = "ImgPic";
            switch (Type) {
                case "Pic":
                    sentID = "ImgPic";
                    break;
                default:
                    sentID = "";
                    break;
            }

            $('#Screenshot').removeClass("display-None");
            Screenshot(sentID);
        });
    }
</script>